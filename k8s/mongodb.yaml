
apiVersion: apps/v1                                                 
kind: Deployment                                                    
metadata:                                                           
  name: mongodb                                                     
  namespace: ogscout-dev                                            
spec:                                                               
  replicas: 1                                                       
  selector:                                                         
    matchLabels:                                                    
      app: mongodb                                                  
  template:                                                         
    metadata:                                                       
      labels:                                                       
        app: mongodb                                                
    spec:                                                           
      containers:                                                   
      - name: mongodb                                               
        image: mongo:6.0                                            
        ports:                                                      
        - containerPort: 27017                                      
        env:                                                        
        - name: MONGO_INITDB_ROOT_USERNAME                          
          valueFrom:                                                
            secretKeyRef:                                           
              name: mongodb-secret                                  
              key: username                                         
        - name: MONGO_INITDB_ROOT_PASSWORD                          
          valueFrom:                                                
            secretKeyRef:                                           
              name: mongodb-secret                                  
              key: password                                         
        volumeMounts:                                               
        - name: mongodb-data                                        
          mountPath: /data/db                                       
      volumes:                                                      
      - name: mongodb-data                                          
        persistentVolumeClaim:                                      
          claimName: mongodb-pvc                                    
                                                                    
---                                                                 
                                                                    
apiVersion: v1                                                      
kind: Service                                                       
metadata:                                                           
  name: mongodb                                                     
  namespace: ogscout-dev                                            
spec:                                                               
  selector:                                                         
    app: mongodb                                                    
  ports:                                                            
  - port: 27017                                                     
    targetPort: 27017                                               
  clusterIP: None                                                   
                                                                    
---                                                                 
                                                                    
apiVersion: v1                                                      
kind: PersistentVolumeClaim                                         
metadata:                                                           
  name: mongodb-pvc                                                 
  namespace: ogscout-dev                                            
spec:                                                               
  accessModes:                                                      
  - ReadWriteOnce                                                   
  resources:                                                        
    requests:                                                       
      storage: 1Gi